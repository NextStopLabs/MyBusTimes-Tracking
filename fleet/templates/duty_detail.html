{% extends "mbtbase.html" %}
{% load static %}


{% block extra_css %}
<link rel="stylesheet" type="text/css" href="{% static 'css/narrow.css' %}">
{% endblock %}

{% block title %}
{{ duty.duty_name }} - Duty Detail
{% endblock %}

{% block content %}
<h1>{{ duty.duty_name }}</h1>
<div class="in-page-ad" id="body-ad-1">
  <div class="incontent-ad-container" style="height:100px;">
    <div id="AFM_inContent_ad" style="margin:auto;"></div>
  </div>
</div>
<button onclick='window.location.href="{% url 'generate_pdf' duty.duty_operator.operator_slug duty.id %}"'>Print/Download</button>
{% if 'Edit Duties' in user_perms or 'owner' in user_perms %}
<button onclick='window.location.href="{% url 'edit-duty' duty.duty_operator.operator_slug duty.id %}"'>Edit Duty</button>
{% endif %}
{% if user.is_superuser %}<a style="font-size: 14px;" href="/api-admin/routes/duty/{{ duty.id }}/change/">✎</a>{% endif %}
<p>Days:
    {% for day in duty.duty_day.all %}
        <span>{{ day.name }}{% if not forloop.last %},{% endif %}</span>
    {% endfor %}
</p>
<p>Operator: <a href="{% url 'operator' duty.duty_operator.operator_slug %}">{{ duty.duty_operator.operator_name }}</a></p>

<p>Trips:<br>
    {% for trip in trips %}
        <span>{{ trip.start_time|date:"H:i" }} - {{ trip.end_time|date:"H:i" }}:
            {% if trip.route_link %}
                <a href="/operator/{% for op in trip.route_link.route_operators.all %}{% if forloop.first %}{{ op.operator_slug }}{% endif %}{% endfor %}/route/{{ trip.route_link.id }}">
                    {{ trip.route_link.route_num }} → {{ trip.end_at }} | ({{ trip.inbound|yesno:"Inbound,Outbound" }})
                </a>
            {% else %}
                {{ trip.route }}
            {% endif %}
        </span><br>
    {% endfor %}
</p>
{% endblock %}